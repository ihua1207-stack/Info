<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èšé¤é¸ä½è¡¨</title>
    <style>
        body { font-family: 'å¾®è»Ÿæ­£é»‘é«”', sans-serif; background-color: #f0f2f5; text-align: center; padding: 20px; }
        h1 { color: #333; }
        .restaurant { display: grid; grid-template-columns: repeat(2, 1fr); gap: 30px; max-width: 600px; margin: 0 auto; }
        
        /* æ¡Œå­æ¨£å¼ */
        .table-group { background: #fff; padding: 15px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .table-title { font-weight: bold; margin-bottom: 10px; color: #555; }
        .seats { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }

        /* åº§ä½æ¨£å¼ */
        .seat {
            padding: 15px 5px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.2s;
            font-size: 14px;
            background: #e6fffa; /* é è¨­ç¶ è‰² (ç©ºä½) */
            color: #2c7a7b;
        }
        .seat:hover { background: #b2f5ea; }
        
        /* å·²ä½”ç”¨æ¨£å¼ */
        .seat.occupied {
            background-color: #feb2b2; /* ç´…è‰² (æœ‰äºº) */
            color: #c53030;
            border-color: #fc8181;
            cursor: not-allowed;
        }

        /* éŸ¿æ‡‰å¼ï¼šæ‰‹æ©Ÿè®Šå–®æ’ */
        @media (max-width: 500px) { .restaurant { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <h1>ğŸ½ï¸ èšé¤åº§ä½é¸æ“‡ (4æ¡Œ x 4äºº)</h1>
    <p>é»æ“Šç¶ è‰²åº§ä½è¼¸å…¥åå­—ï¼Œç´…è‰²ä»£è¡¨å·²æœ‰äººã€‚</p>

    <div id="app" class="restaurant">
        <!-- å…§å®¹æœƒç”± JS è‡ªå‹•ç”¢ç”Ÿ -->
        è¼‰å…¥ä¸­...
    </div>

    <!-- å¼•å…¥ Firebase -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, onValue, update } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // ğŸ”´ è«‹å°‡ä¸‹æ–¹çš„è¨­å®šæ›¿æ›æˆä½ è‡ªå·±åœ¨ Firebase ç”³è«‹çš„å…§å®¹
        const firebaseConfig = {
  apiKey: "AIzaSyDDZoM7D1aNDAekAcjZLnvSiLaEhWd7apU",

  authDomain: "arrangement-8234f.firebaseapp.com",

  databaseURL: "https://arrangement-8234f-default-rtdb.firebaseio.com",

  projectId: "arrangement-8234f",

  storageBucket: "arrangement-8234f.firebasestorage.app",

  messagingSenderId: "443718243726",

  appId: "1:443718243726:web:efe97ca747b296b74640df",

        };

        // åˆå§‹åŒ– Firebase
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const seatsRef = ref(db, 'seats');

        // å®šç¾©åº§ä½çµæ§‹ (4æ¡Œï¼Œæ¯æ¡Œ4äºº)
        const totalTables = 4;
        const seatsPerTable = 4;

        // æ¸²æŸ“ç•«é¢å‡½æ•¸
        function renderSeats(data) {
            const container = document.getElementById('app');
            container.innerHTML = ''; // æ¸…ç©º

            for (let t = 1; t <= totalTables; t++) {
                const tableDiv = document.createElement('div');
                tableDiv.className = 'table-group';
                tableDiv.innerHTML = `<div class="table-title">ç¬¬ ${t} æ¡Œ</div>`;
                
                const seatsDiv = document.createElement('div');
                seatsDiv.className = 'seats';

                for (let s = 1; s <= seatsPerTable; s++) {
                    const seatId = `t${t}_s${s}`;
                    const occupant = data ? data[seatId] : null;
                    
                    const btn = document.createElement('div');
                    btn.className = `seat ${occupant ? 'occupied' : ''}`;
                    btn.textContent = occupant ? occupant : `åº§ä½ ${s}`;
                    
                    // é»æ“Šäº‹ä»¶
                    if (!occupant) {
                        btn.onclick = () => selectSeat(seatId);
                    } else {
                        btn.onclick = () => alert(`é€™è£¡æ˜¯ ${occupant} çš„ä½å­å›‰ï¼`);
                    }
                    seatsDiv.appendChild(btn);
                }
                tableDiv.appendChild(seatsDiv);
                container.appendChild(tableDiv);
            }
        }

        // é»æ“Šé¸ä½é‚è¼¯
        function selectSeat(seatId) {
            const name = prompt("è«‹è¼¸å…¥ä½ çš„åå­—ï¼š");
            if (name && name.trim() !== "") {
                const updates = {};
                updates[seatId] = name;
                // æ›´æ–°è³‡æ–™åº«
                update(seatsRef, updates)
                    .then(() => alert("é¸ä½æˆåŠŸï¼"))
                    .catch((err) => alert("ç™¼ç”ŸéŒ¯èª¤ï¼š" + err));
            }
        }

        // ç›£è½è³‡æ–™åº«è®Šå‹• (å³æ™‚åŒæ­¥é—œéµ)
        onValue(seatsRef, (snapshot) => {
            const data = snapshot.val() || {};
            renderSeats(data);
        });

    </script>
</body>
</html>